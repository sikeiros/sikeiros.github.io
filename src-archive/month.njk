---
layout: base.njk

# one page per month: /archive/posts/YYYY-MM/
pagination:
  data: collections.postsByMonth
  size: 1
  alias: month

# Month page URL = /archive/posts/YYYY-MM/
permalink: "posts/{{ month.ym }}/"

eleventyComputed:
  title: "Archive {{ month.ym | monthLabel }}"
  htmlClass: "is-archive"
---

{# groups = months that actually have posts (newest â†’ oldest) #}
{% set groups = collections.postsByMonth %}

{# Build a months list like in your local file.
   If you want disabled months too, we make a full window from the oldest month to newest. #}
{% set oldest = groups[(groups | length) - 1].ym %}
{% set months = oldest | monthWindowFixed(groups | length) %}

<main class="content">
  <h1>Archive</h1>

  <nav class="months" aria-label="Months">
    {% for ym in months %}
      {# does this ym have posts? #}
      {% set has = false %}
      {% for g in groups %}{% if g.ym == ym %}{% set has = true %}{% endif %}{% endfor %}

      {% if has %}
        <a class="month"
           href="{{ ('/posts/' + ym + '/') | url }}"
           {% if ym == month.ym %}aria-current="true"{% endif %}>
          {{ ym | monthLabel }}
        </a>
      {% else %}
        <span class="month" aria-disabled="true">{{ ym | monthLabel }}</span>
      {% endif %}
    {% endfor %}
  </nav>

  {% if month.items and month.items.length %}
    {% for post in month.items %}
      <article class="entry">
        <time class="chip">{{ post.date | dateChip }}</time>

        {% if post.data.title %}
          <h3 class="entry-title">{{ post.data.title }}</h3>
        {% endif %}

        <div class="entry-body">
          {{ post.content | safe }} {# full post body inline #}
        </div>
      </article>
    {% endfor %}
  {% else %}
    <p class="note">No posts in this month yet.</p>
  {% endif %}

  <div class="footer">
    This is a live archive of works, thoughts, screenshots. Nothing final, the process.
  </div>
</main>
